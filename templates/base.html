<!DOCTYPE html>
<html lang="ca">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Backlog de Videojocs{% endblock %}</title>
    <!-- Add particles.js and a gaming font -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <script
        src="https://cdn.jsdelivr.net/npm/tsparticles-preset-triangles@2/tsparticles.preset.triangles.bundle.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Particulas y glow interactivo */
        #cursor-glow {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(0, 255, 204, 0.15) 0%, rgba(0, 255, 204, 0) 70%);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
            mix-blend-mode: screen;
        }

        /* Animación inicial en las tarjetas */
        .card {
            opacity: 0;
            transform: translateY(20px);
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .card:nth-child(4) {
            animation-delay: 0.4s;
        }

        .card:nth-child(5) {
            animation-delay: 0.5s;
        }

        .card:nth-child(6) {
            animation-delay: 0.6s;
        }

        @keyframes slideUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body style="font-family: 'Orbitron', sans-serif;">
    <!-- Contenedor para partículas -->
    <div id="tsparticles" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;"></div>

    <div id="cursor-glow"></div>
    <div class="scanlines"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); background-size: 100% 2px, 3px 100%; z-index: 9998; pointer-events: none; opacity: 0.15;">
    </div>

    <nav class="navbar">
        <a href="{{ url_for('index') }}" class="navbar-brand">GameBacklog</a>
        <ul class="navbar-nav">
            <li class="nav-item"><a href="{{ url_for('games') }}"
                    class="{% if request.endpoint in ('games', 'game_detail') %}active{% endif %}">Catàleg</a></li>
            {% if current_user.is_authenticated %}
            <li class="nav-item"><a href="{{ url_for('dashboard') }}"
                    class="{% if request.endpoint == 'dashboard' %}active{% endif %}">Dashboard</a></li>
            <li class="nav-item"><a href="{{ url_for('backlog') }}"
                    class="{% if request.endpoint in ('backlog', 'backlog_add') %}active{% endif %}">El meu Backlog</a>
            </li>
            <li class="nav-item"><a href="{{ url_for('lists') }}"
                    class="{% if request.endpoint in ('lists', 'list_detail') %}active{% endif %}">Llistes</a></li>
            <li class="nav-item"><a href="{{ url_for('logout') }}" style="color: var(--secondary-color);">Tancar sessió
                    ({{ current_user.username }})</a></li>
            {% else %}
            <li class="nav-item"><a href="{{ url_for('login') }}"
                    class="{% if request.endpoint == 'login' %}active{% endif %}">Iniciar sessió</a></li>
            <li class="nav-item"><a href="{{ url_for('register') }}" style="color: var(--primary-color);"
                    class="{% if request.endpoint == 'register' %}active{% endif %}">Registrar-se</a></li>
            {% endif %}
            <li class="nav-item"><a href="{{ url_for('about') }}"
                    class="{% if request.endpoint == 'about' %}active{% endif %}">About me</a></li>
        </ul>
    </nav>

    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}

        <div id="content-container">
            {% block content %}{% endblock %}
        </div>
    </div>

    <script>
        // Inicializar partículas TS
        tsParticles.load("tsparticles", {
            preset: "triangles",
            background: {
                color: { value: "transparent" }
            },
            particles: {
                color: { value: "#00ffcc" },
                links: { color: "#00ffcc", opacity: 0.2 },
                move: { speed: 1 }
            }
        });

        // Animaciones de partículas y cursor
        const glow = document.getElementById('cursor-glow');

        document.addEventListener('mousemove', (e) => {
            glow.style.left = e.clientX + 'px';
            glow.style.top = e.clientY + 'px';
        });

        // Efectos dinámicos en los botones al hacer hover
        document.querySelectorAll('.btn, a').forEach(el => {
            el.addEventListener('mouseenter', () => {
                glow.style.width = '600px';
                glow.style.height = '600px';
                if (el.classList.contains('btn-danger')) {
                    glow.style.background = 'radial-gradient(circle, rgba(255, 0, 127, 0.2) 0%, rgba(255, 0, 127, 0) 70%)';
                }
            });
            el.addEventListener('mouseleave', () => {
                glow.style.width = '400px';
                glow.style.height = '400px';
                glow.style.background = 'radial-gradient(circle, rgba(0, 255, 204, 0.15) 0%, rgba(0, 255, 204, 0) 70%)';
            });
        });

        // Glitch text effect on hover para títulos
        document.querySelectorAll('h1, h2, .navbar-brand').forEach(title => {
            title.addEventListener('mouseenter', function () {
                this.style.animation = 'none';
                this.offsetHeight; /* trigger reflow */
                this.style.animation = 'glitch 0.3s cubic-bezier(.25, .46, .45, .94) both infinite';
            });
            title.addEventListener('mouseleave', function () {
                this.style.animation = 'none';
            });
        });

        // Efecto Tilt en las tarjetas 3D
        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('mousemove', e => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const rotateX = ((y - centerY) / centerY) * -5;
                const rotateY = ((x - centerX) / centerX) * 5;

                card.style.transform = `perspective(1000px) scale(1.02) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = `perspective(1000px) scale(1) rotateX(0) rotateY(0)`;
            });
        });

        // Efecto sonido hover para los botones (simulado con synth API por modernidad)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playHoverSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime); // high ping
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.05);
            gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.1);
        }

        document.querySelectorAll('.btn').forEach(btn => {
            btn.addEventListener('mouseenter', playHoverSound);
        });

        // Konami Code Easter Egg
        const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
        let konamiIndex = 0;
        document.addEventListener('keydown', (e) => {
            if (e.key === konamiCode[konamiIndex]) {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    activateOverclock();
                    konamiIndex = 0;
                }
            } else {
                konamiIndex = 0;
            }
        });

        function activateOverclock() {
            document.body.classList.add('overclocked');
            alert("SYSTEM OVERRIDE: OVERCLOCK MAXIMIZED!");
            // Modify particles speed
            const particles = tsParticles.domItem(0);
            if (particles) {
                particles.options.particles.move.speed = 15;
                particles.options.particles.color.value = "#ff0000";
                particles.options.particles.links.color = "#ff0000";
                particles.refresh();
            }
        }
    </script>
    <style>
        @keyframes glitch {
            0% {
                transform: translate(0)
            }

            20% {
                transform: translate(-2px, 2px)
            }

            40% {
                transform: translate(-2px, -2px)
            }

            60% {
                transform: translate(2px, 2px)
            }

            80% {
                transform: translate(2px, -2px)
            }

            100% {
                transform: translate(0)
            }
        }

        .overclocked {
            animation: rgbShift 2s infinite, screenShake 0.5s infinite;
            filter: contrast(1.2) saturate(1.5);
        }

        .overclocked .card {
            border-color: #ff0000 !important;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5) !important;
        }

        .overclocked h1,
        .overclocked h2,
        .overclocked h3 {
            color: #ff0000 !important;
            text-shadow: 0 0 15px #ff0000 !important;
        }

        @keyframes rgbShift {
            0% {
                filter: hue-rotate(0deg);
            }

            100% {
                filter: hue-rotate(360deg);
            }
        }

        @keyframes screenShake {
            0% {
                transform: translate(1px, 1px) rotate(0deg);
            }

            10% {
                transform: translate(-1px, -2px) rotate(-1deg);
            }

            20% {
                transform: translate(-3px, 0px) rotate(1deg);
            }

            30% {
                transform: translate(3px, 2px) rotate(0deg);
            }

            40% {
                transform: translate(1px, -1px) rotate(1deg);
            }

            50% {
                transform: translate(-1px, 2px) rotate(-1deg);
            }

            60% {
                transform: translate(-3px, 1px) rotate(0deg);
            }

            70% {
                transform: translate(3px, 1px) rotate(-1deg);
            }

            80% {
                transform: translate(-1px, -1px) rotate(1deg);
            }

            90% {
                transform: translate(1px, 2px) rotate(0deg);
            }

            100% {
                transform: translate(1px, -2px) rotate(-1deg);
            }
        }
    </style>
</body>

</html>